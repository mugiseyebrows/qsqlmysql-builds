name: main
on:
  push:
    tags: '*'
jobs:
  main:
    runs-on: windows-2019
    steps:
    - name: test env
      shell: cmd
      run: |
        where cmake || exit /b 0
        where perl || exit /b 0
        where curl || exit /b 0
        where 7z || exit /b 0
    - name: install ninja
      shell: cmd
      run: |
        set PATH=C:\Miniconda;C:\Miniconda\Scripts;%PATH%
        pip install aqtinstall
        aqt install-tool windows desktop tools_ninja qt.tools.ninja
    - name: flavour qt6.2.0 msvc2019 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.0.zip" curl -L -o qtbase-everywhere-src-6.2.0.zip "https://download.qt.io/official_releases/qt/6.2/6.2.0/submodules/qtbase-everywhere-src-6.2.0.zip"
        if exist qtbase-everywhere-src-6.2.0 rmdir /q /s qtbase-everywhere-src-6.2.0
        7z x -y "qtbase-everywhere-src-6.2.0.zip"
        set INCLUDE=
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.0-msvc2019-x86_64" mkdir "qsqlmysql-qt6.2.0-msvc2019-x86_64"
        pushd qtbase-everywhere-src-6.2.0
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.0\msvc2019_64 -DQT_QMAKE_TARGET_MKSPEC=win32-msvc -DCMAKE_C_COMPILER=cl -DCMAKE_CXX_COMPILER=cl -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.0-msvc2019-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.0-msvc2019-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.0-msvc2019-x86_64.zip" "qsqlmysql-qt6.2.0-msvc2019-x86_64"
        if exist qtbase-everywhere-src-6.2.0 rmdir /q /s qtbase-everywhere-src-6.2.0
    - name: flavour qt6.2.0 mingw8.1.0 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.0.zip" curl -L -o qtbase-everywhere-src-6.2.0.zip "https://download.qt.io/official_releases/qt/6.2/6.2.0/submodules/qtbase-everywhere-src-6.2.0.zip"
        if exist qtbase-everywhere-src-6.2.0 rmdir /q /s qtbase-everywhere-src-6.2.0
        7z x -y "qtbase-everywhere-src-6.2.0.zip"
        if not exist "x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z" curl -L -o x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z "https://versaweb.dl.sourceforge.net/project/mingw-w64/Toolchains%%20targetting%%20Win64/Personal%%20Builds/mingw-builds/8.1.0/threads-posix/seh/x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z"
        if exist mingw64 rmdir /q /s mingw64
        7z x -y "x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\mingw64\bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.0-mingw8.1.0-x86_64" mkdir "qsqlmysql-qt6.2.0-mingw8.1.0-x86_64"
        pushd qtbase-everywhere-src-6.2.0
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.0\mingw81_64 -DQT_QMAKE_TARGET_MKSPEC=win32-g++ -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.0-mingw8.1.0-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.0-mingw8.1.0-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.0-mingw8.1.0-x86_64.zip" "qsqlmysql-qt6.2.0-mingw8.1.0-x86_64"
        if exist qtbase-everywhere-src-6.2.0 rmdir /q /s qtbase-everywhere-src-6.2.0
    - name: flavour qt6.2.1 msvc2019 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.1.zip" curl -L -o qtbase-everywhere-src-6.2.1.zip "https://download.qt.io/official_releases/qt/6.2/6.2.1/submodules/qtbase-everywhere-src-6.2.1.zip"
        if exist qtbase-everywhere-src-6.2.1 rmdir /q /s qtbase-everywhere-src-6.2.1
        7z x -y "qtbase-everywhere-src-6.2.1.zip"
        set INCLUDE=
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.1-msvc2019-x86_64" mkdir "qsqlmysql-qt6.2.1-msvc2019-x86_64"
        pushd qtbase-everywhere-src-6.2.1
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.1\msvc2019_64 -DQT_QMAKE_TARGET_MKSPEC=win32-msvc -DCMAKE_C_COMPILER=cl -DCMAKE_CXX_COMPILER=cl -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.1-msvc2019-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.1-msvc2019-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.1-msvc2019-x86_64.zip" "qsqlmysql-qt6.2.1-msvc2019-x86_64"
        if exist qtbase-everywhere-src-6.2.1 rmdir /q /s qtbase-everywhere-src-6.2.1
    - name: flavour qt6.2.1 mingw8.1.0 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.1.zip" curl -L -o qtbase-everywhere-src-6.2.1.zip "https://download.qt.io/official_releases/qt/6.2/6.2.1/submodules/qtbase-everywhere-src-6.2.1.zip"
        if exist qtbase-everywhere-src-6.2.1 rmdir /q /s qtbase-everywhere-src-6.2.1
        7z x -y "qtbase-everywhere-src-6.2.1.zip"
        if not exist "x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z" curl -L -o x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z "https://versaweb.dl.sourceforge.net/project/mingw-w64/Toolchains%%20targetting%%20Win64/Personal%%20Builds/mingw-builds/8.1.0/threads-posix/seh/x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z"
        if exist mingw64 rmdir /q /s mingw64
        7z x -y "x86_64-8.1.0-release-posix-seh-rt_v6-rev0.7z"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\mingw64\bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.1-mingw8.1.0-x86_64" mkdir "qsqlmysql-qt6.2.1-mingw8.1.0-x86_64"
        pushd qtbase-everywhere-src-6.2.1
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.1\mingw81_64 -DQT_QMAKE_TARGET_MKSPEC=win32-g++ -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.1-mingw8.1.0-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.1-mingw8.1.0-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.1-mingw8.1.0-x86_64.zip" "qsqlmysql-qt6.2.1-mingw8.1.0-x86_64"
        if exist qtbase-everywhere-src-6.2.1 rmdir /q /s qtbase-everywhere-src-6.2.1
    - name: flavour qt6.2.2 msvc2019 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.2.zip" curl -L -o qtbase-everywhere-src-6.2.2.zip "https://download.qt.io/official_releases/qt/6.2/6.2.2/submodules/qtbase-everywhere-src-6.2.2.zip"
        if exist qtbase-everywhere-src-6.2.2 rmdir /q /s qtbase-everywhere-src-6.2.2
        7z x -y "qtbase-everywhere-src-6.2.2.zip"
        set INCLUDE=
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.2-msvc2019-x86_64" mkdir "qsqlmysql-qt6.2.2-msvc2019-x86_64"
        pushd qtbase-everywhere-src-6.2.2
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.2\msvc2019_64 -DQT_QMAKE_TARGET_MKSPEC=win32-msvc -DCMAKE_C_COMPILER=cl -DCMAKE_CXX_COMPILER=cl -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.2-msvc2019-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.2-msvc2019-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.2-msvc2019-x86_64.zip" "qsqlmysql-qt6.2.2-msvc2019-x86_64"
        if exist qtbase-everywhere-src-6.2.2 rmdir /q /s qtbase-everywhere-src-6.2.2
    - name: flavour qt6.2.2 mingw11.2.0 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.2.zip" curl -L -o qtbase-everywhere-src-6.2.2.zip "https://download.qt.io/official_releases/qt/6.2/6.2.2/submodules/qtbase-everywhere-src-6.2.2.zip"
        if exist qtbase-everywhere-src-6.2.2 rmdir /q /s qtbase-everywhere-src-6.2.2
        7z x -y "qtbase-everywhere-src-6.2.2.zip"
        if not exist "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z" curl -L -o x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z "https://github.com/cristianadam/mingw-builds/releases/download/v11.2.0-rev1/x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        if exist mingw64 rmdir /q /s mingw64
        7z x -y "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\mingw64\bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.2-mingw11.2.0-x86_64" mkdir "qsqlmysql-qt6.2.2-mingw11.2.0-x86_64"
        pushd qtbase-everywhere-src-6.2.2
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.2\mingw112_64 -DQT_QMAKE_TARGET_MKSPEC=win32-g++ -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.2-mingw11.2.0-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.2-mingw11.2.0-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.2-mingw11.2.0-x86_64.zip" "qsqlmysql-qt6.2.2-mingw11.2.0-x86_64"
        if exist qtbase-everywhere-src-6.2.2 rmdir /q /s qtbase-everywhere-src-6.2.2
    - name: flavour qt6.2.3 msvc2019 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.3.zip" curl -L -o qtbase-everywhere-src-6.2.3.zip "https://download.qt.io/official_releases/qt/6.2/6.2.3/submodules/qtbase-everywhere-src-6.2.3.zip"
        if exist qtbase-everywhere-src-6.2.3 rmdir /q /s qtbase-everywhere-src-6.2.3
        7z x -y "qtbase-everywhere-src-6.2.3.zip"
        set INCLUDE=
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.3-msvc2019-x86_64" mkdir "qsqlmysql-qt6.2.3-msvc2019-x86_64"
        pushd qtbase-everywhere-src-6.2.3
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.3\msvc2019_64 -DQT_QMAKE_TARGET_MKSPEC=win32-msvc -DCMAKE_C_COMPILER=cl -DCMAKE_CXX_COMPILER=cl -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.3-msvc2019-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.3-msvc2019-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.3-msvc2019-x86_64.zip" "qsqlmysql-qt6.2.3-msvc2019-x86_64"
        if exist qtbase-everywhere-src-6.2.3 rmdir /q /s qtbase-everywhere-src-6.2.3
    - name: flavour qt6.2.3 mingw11.2.0 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.3.zip" curl -L -o qtbase-everywhere-src-6.2.3.zip "https://download.qt.io/official_releases/qt/6.2/6.2.3/submodules/qtbase-everywhere-src-6.2.3.zip"
        if exist qtbase-everywhere-src-6.2.3 rmdir /q /s qtbase-everywhere-src-6.2.3
        7z x -y "qtbase-everywhere-src-6.2.3.zip"
        if not exist "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z" curl -L -o x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z "https://github.com/cristianadam/mingw-builds/releases/download/v11.2.0-rev1/x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        if exist mingw64 rmdir /q /s mingw64
        7z x -y "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\mingw64\bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.3-mingw11.2.0-x86_64" mkdir "qsqlmysql-qt6.2.3-mingw11.2.0-x86_64"
        pushd qtbase-everywhere-src-6.2.3
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.3\mingw112_64 -DQT_QMAKE_TARGET_MKSPEC=win32-g++ -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.3-mingw11.2.0-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.3-mingw11.2.0-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.3-mingw11.2.0-x86_64.zip" "qsqlmysql-qt6.2.3-mingw11.2.0-x86_64"
        if exist qtbase-everywhere-src-6.2.3 rmdir /q /s qtbase-everywhere-src-6.2.3
    - name: flavour qt6.2.4 msvc2019 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.4.zip" curl -L -o qtbase-everywhere-src-6.2.4.zip "https://download.qt.io/official_releases/qt/6.2/6.2.4/submodules/qtbase-everywhere-src-6.2.4.zip"
        if exist qtbase-everywhere-src-6.2.4 rmdir /q /s qtbase-everywhere-src-6.2.4
        7z x -y "qtbase-everywhere-src-6.2.4.zip"
        set INCLUDE=
        call "C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\VC\Auxiliary\Build\vcvars64.bat"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.4-msvc2019-x86_64" mkdir "qsqlmysql-qt6.2.4-msvc2019-x86_64"
        pushd qtbase-everywhere-src-6.2.4
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.4\msvc2019_64 -DQT_QMAKE_TARGET_MKSPEC=win32-msvc -DCMAKE_C_COMPILER=cl -DCMAKE_CXX_COMPILER=cl -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.4-msvc2019-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.4-msvc2019-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.4-msvc2019-x86_64.zip" "qsqlmysql-qt6.2.4-msvc2019-x86_64"
        if exist qtbase-everywhere-src-6.2.4 rmdir /q /s qtbase-everywhere-src-6.2.4
    - name: flavour qt6.2.4 mingw11.2.0 x86_64
      shell: cmd
      run: |
        if exist clear-env.bat call clear-env.bat
        if not exist "mysql-8.0.29-winx64.zip" curl -L -o mysql-8.0.29-winx64.zip "https://cdn.mysql.com//Downloads/MySQL-8.0/mysql-8.0.29-winx64.zip"
        if not exist "mysql-8.0.29-winx64" 7z x -y "mysql-8.0.29-winx64.zip"
        if not exist "qtbase-everywhere-src-6.2.4.zip" curl -L -o qtbase-everywhere-src-6.2.4.zip "https://download.qt.io/official_releases/qt/6.2/6.2.4/submodules/qtbase-everywhere-src-6.2.4.zip"
        if exist qtbase-everywhere-src-6.2.4 rmdir /q /s qtbase-everywhere-src-6.2.4
        7z x -y "qtbase-everywhere-src-6.2.4.zip"
        if not exist "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z" curl -L -o x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z "https://github.com/cristianadam/mingw-builds/releases/download/v11.2.0-rev1/x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        if exist mingw64 rmdir /q /s mingw64
        7z x -y "x86_64-11.2.0-release-posix-seh-rt_v9-rev1.7z"
        set PATH=%CD%/mysql-8.0.29-winx64/lib;%CD%/mysql-8.0.29-winx64/bin;%CD%\mingw64\bin;%CD%\Tools\Ninja;%PATH%
        if not exist "qsqlmysql-qt6.2.4-mingw11.2.0-x86_64" mkdir "qsqlmysql-qt6.2.4-mingw11.2.0-x86_64"
        pushd qtbase-everywhere-src-6.2.4
        cmake -DBUILD_SHARED_LIBS=ON -DCMAKE_INSTALL_PREFIX=C:\Qt\6.2.4\mingw112_64 -DQT_QMAKE_TARGET_MKSPEC=win32-g++ -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DQT_BUILD_TESTS=FALSE -DQT_BUILD_EXAMPLES=FALSE -DCMAKE_CONFIGURATION_TYPES=Release;Debug -DQT_EXTRA_DEFINES=MySQL_INCLUDE_DIR=%CD%/../mysql-8.0.29-winx64/include;MySQL_LIBRARY=%CD%/../mysql-8.0.29-winx64/lib/libmysql.lib -DINPUT_opengl=desktop -G "Ninja Multi-Config" .
        ninja qsqlmysql.dll
        copy /y "plugins\sqldrivers\qsqlmysql.dll" "..\qsqlmysql-qt6.2.4-mingw11.2.0-x86_64"
        copy /y "plugins\sqldrivers\qsqlmysqld.dll" "..\qsqlmysql-qt6.2.4-mingw11.2.0-x86_64"
        popd
        if not exist "libmysql-x86_64" mkdir "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.dll" "libmysql-x86_64"
        copy /y "mysql-8.0.29-winx64\lib\libmysql.lib" "libmysql-x86_64"
        7z a "libmysql-x86_64.zip" "libmysql-x86_64"
        7z a "qsqlmysql-qt6.2.4-mingw11.2.0-x86_64.zip" "qsqlmysql-qt6.2.4-mingw11.2.0-x86_64"
        if exist qtbase-everywhere-src-6.2.4 rmdir /q /s qtbase-everywhere-src-6.2.4
    - uses: ncipollo/release-action@v1
      if: startsWith( github.ref, 'refs/tags/')
      with:
        artifacts: |
          qsqlmysql-qt6.2.0-msvc2019-x86_64.zip
          qsqlmysql-qt6.2.0-mingw8.1.0-x86_64.zip
          qsqlmysql-qt6.2.1-msvc2019-x86_64.zip
          qsqlmysql-qt6.2.1-mingw8.1.0-x86_64.zip
          qsqlmysql-qt6.2.2-msvc2019-x86_64.zip
          qsqlmysql-qt6.2.2-mingw11.2.0-x86_64.zip
          qsqlmysql-qt6.2.3-msvc2019-x86_64.zip
          qsqlmysql-qt6.2.3-mingw11.2.0-x86_64.zip
          qsqlmysql-qt6.2.4-msvc2019-x86_64.zip
          qsqlmysql-qt6.2.4-mingw11.2.0-x86_64.zip
          libmysql-x86_64.zip
        token: ${{ secrets.GITHUB_TOKEN }}
